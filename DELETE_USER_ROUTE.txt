  // DELETE /api/admin/users/:id - Delete a user (owner can delete anyone, admins can delete regular users)
  app.delete("/api/admin/users/:id", isAdmin, async (req, res) => {
    try {
      const userId = parseInt(req.params.id);
      
      // Prevent self-deletion
      if (userId === req.user!.id) {
        return res.status(400).send("You cannot delete yourself");
      }
      
      // Get user to check if they exist and their role
      const userToDelete = await storage.getUser(userId);
      if (!userToDelete) {
        return res.status(404).send("User not found");
      }
      
      // Prevent deletion of owner by admins
      if (userToDelete.role === 'owner' && req.user!.role !== 'owner') {
        return res.status(403).send("Admins cannot delete owners");
      }
      
      await storage.deleteUser(userId);
      res.json({ message: "User deleted successfully" });
    } catch (error) {
      console.error('Error deleting user:', error);
      res.status(500).send("Failed to delete user");
    }
  });
